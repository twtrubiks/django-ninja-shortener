# 📝 MVP 短網址服務開發清單 (Django Ninja + PostgreSQL)

## Ⅰ. 規劃與設定 (MVP 範疇) 🎯

* **明確 MVP 功能邊界：**
  * **核心：** 使用者登入後，能輸入長網址產生短網址；點擊短網址能正確重定向。
  * **UI 模仿 Bitly (簡化版)：** 簡潔的輸入介面、短網址結果顯示、使用者個人短網址列表。
  * **追蹤資訊 (MVP 級別)：** 至少包含每個短網址的「總點擊次數」。(增加：最後點擊時間)

## Ⅱ. 後端核心功能開發 ⚙️

* **資料庫模型設計 (`models.py`)：**
  * **使用者模型：** 直接使用 Django 內建的 `User` 模型。
  * **短網址連結 (`Link`) 模型：**
    * `original_url` (原始長網址)
    * `short_code` (生成的短代碼 - 確保唯一、加索引)
    * `owner` (外鍵關聯到 `User` 模型，表示創建者)
    * `created_at` (建立時間)
    * `click_count` (點擊次數，預設為 0)
    * `(可選 MVP)` `last_clicked_at` (最後點擊時間)
* **執行資料庫遷移：** 根據模型定義更新 PostgreSQL 資料庫結構。
* **短代碼生成邏輯：**
  * 設計一個函數產生簡短且唯一的字串作為 `short_code`。
  * 確保生成的代碼在資料庫中不重複。
* **API 端點設計與實作 (`api.py` using Django Ninja)：**
  * **`POST /api/shorten` (建立短網址 - 需登入)：**
    * 接收使用者提交的長網址。
    * 驗證輸入。
    * 調用短代碼生成邏輯。
    * 將長網址、短代碼、擁有者等資訊存入資料庫。
    * 回傳新產生的短網址及相關資訊。
* **重定向邏輯實作 (`views.py` 或 `api.py`)：**
  * **`GET /{short_code}` (短網址重定向)：**
    * 接收 URL 路徑中的 `short_code`。
    * 查詢資料庫，找到對應的原始長網址。
    * **重要：** 增加對應 `Link` 記錄的 `click_count`。
    * (可選 MVP) 更新 `last_clicked_at`。
    * 執行 HTTP 301 或 302 重定向到 `original_url`。
    * 處理 `short_code` 不存在或無效的情況 (例如回傳 404)。

## Ⅲ. 使用者身份驗證 🔑

* **整合 Django 內建認證系統：** 利用 Django 提供的使用者註冊、登入、登出功能。
* **開發認證相關的 API 端點或頁面視圖：**
  * 使用者註冊介面/API。
  * 使用者登入介面/API。
  * 使用者登出功能。
* **API 端點權限設定：** 確保「建立短網址」的 API 必須在使用者登入狀態下才能調用。

## Ⅳ. UI 介面開發 (模仿 Bitly 風格 - MVP 版) 🖥️

* CSS 風格請使用 django-tailwind

* **基礎頁面結構規劃 (HTML 模板)：**
  * 導航列 (包含服務名稱、登入/註冊/登出連結、使用者名稱)。
  * 主要內容區域。
* **首頁/短網址生成頁 (`home.html` 或 `dashboard.html`)：**
  * 清晰的長網址輸入框。
  * 「縮短網址」按鈕。
  * 用於顯示生成結果的區域 (短網址、複製按鈕)。
* **使用者短網址列表頁 (儀表板風格)：**
  * 僅顯示當前登入使用者所建立的短網址。
  * 列表應包含：原始長網址、短網址、**總點擊次數**、建立日期。
  * (可選 MVP) 簡單的排序或篩選功能。
* **(可選 MVP) 連結追蹤資訊詳情頁：**
  * 點擊列表中的某個短網址，可以導向一個頁面顯示更詳細的追蹤資訊 (如果 MVP 階段收集了更多資訊)。
* **UI 視圖邏輯 (`views.py`)：**
  * 處理各個頁面的渲染。
  * 處理 UI 表單提交 (例如，透過頁面提交長網址，後端處理後重新整理頁面顯示結果；或 UI透過 JavaScript 調用後端 API)。

## Ⅴ. 追蹤資訊功能實作 📊

* **確認 MVP 追蹤指標：** 已確定為「總點擊次數」，(可選)「最後點擊時間」。
* **更新資料模型：** 確保 `Link` 模型中有 `click_count` 欄位 (已在步驟 II 中規劃)。
* **修改重定向邏輯：** 在每次成功重定向前，增加對應 `Link` 的 `click_count` 並儲存。
* **UI 展示追蹤數據：** 在使用者短網址列表頁顯示每個連結的 `click_count`。

## Ⅵ. 測試與基本部署準備 🚀

* **手動功能測試：**
  * 使用者註冊、登入、登出。
  * 未登入時不能使用縮網址功能。
  * 登入後成功產生短網址。
  * 短網址能正確重定向。
  * 點擊次數能被正確追蹤並顯示。
  * 檢查 UI 頁面顯示是否符合預期。
* **基礎安全性檢查：**
  * 確保 Django `DEBUG` 模式在生產環境為 `False`。
  * 設定 `ALLOWED_HOSTS`。
* **準備部署文件 (概念)：** 了解基本的 Django 部署流程 (例如使用 Gunicorn/Uvicorn)。
